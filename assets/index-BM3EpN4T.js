(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();const n={screen:"intro",teams:[{id:"team-a",name:"Team A",members:[],score:0},{id:"team-b",name:"Team B",members:[],score:0}],choosingTeamId:"team-a",answeringTeamId:null,currentCategory:null,currentQuestionId:null,currentWager:null,hasPassed:!1,showAnswer:!1,questionsByCategory:new Map,gameStarted:!1,editingScores:!1,tempScores:{"team-a":0,"team-b":0}};function l(e){return n.teams.find(t=>t.id===e)}function I(){return l(n.choosingTeamId)}function T(e){return n.teams.find(t=>t.id!==e)}function h(){if(!n.currentQuestionId||!n.currentCategory)return null;const e=n.questionsByCategory.get(n.currentCategory);return(e==null?void 0:e.find(t=>t.id===n.currentQuestionId))||null}function L(){const e=[];for(const[t,r]of n.questionsByCategory){const a=r.filter(o=>!o.used).length;e.push({name:t,remainingCount:a,disabled:a===0})}return e}function W(){for(const[,e]of n.questionsByCategory)if(e.some(t=>!t.used))return!1;return!0}function B(){n.currentCategory=null,n.currentQuestionId=null,n.currentWager=null,n.hasPassed=!1,n.showAnswer=!1,n.answeringTeamId=null}async function P(){try{const[e,t]=await Promise.all([fetch("./teams.json"),fetch("./questions.json")]);if(!e.ok||!t.ok)throw new Error("Failed to fetch data files");const[r,a]=await Promise.all([e.json(),t.json()]);if(r.teams&&Array.isArray(r.teams)&&r.teams.length>=2&&(n.teams[0]={id:"team-a",name:r.teams[0].name||"Team A",members:Array.isArray(r.teams[0].members)?[...r.teams[0].members]:[],score:0},n.teams[1]={id:"team-b",name:r.teams[1].name||"Team B",members:Array.isArray(r.teams[1].members)?[...r.teams[1].members]:[],score:0}),a.questions&&Array.isArray(a.questions))Q(a.questions);else throw new Error("Invalid questions format");return!0}catch(e){return console.error("Error loading game data:",e),!1}}function Q(e){n.questionsByCategory.clear(),e.forEach(t=>{if(!t.id||!t.category||!t.prompt||!t.answer){console.warn("Skipping invalid question:",t);return}const r=t.category;n.questionsByCategory.has(r)||n.questionsByCategory.set(r,[]),n.questionsByCategory.get(r).push({id:t.id,prompt:t.prompt,answer:t.answer,notes:t.notes||"",used:!1})}),console.log("Loaded categories:",Array.from(n.questionsByCategory.keys())),console.log("Question counts:",Array.from(n.questionsByCategory.entries()).map(([t,r])=>`${t}: ${r.length}`))}function k(e){const t=n.questionsByCategory.get(e);return t&&t.find(r=>!r.used)||null}function M(){return n.gameStarted||!n.teams[0].name.trim()||!n.teams[1].name.trim()?!1:(n.gameStarted=!0,n.screen="grid",n.choosingTeamId=n.teams[0].id,!0)}function O(e){if(n.screen!=="grid"||n.currentCategory)return!1;const t=k(e);return t?(n.currentCategory=e,n.currentQuestionId=t.id,n.screen="question",n.currentWager=null,n.hasPassed=!1,n.showAnswer=!1,n.answeringTeamId=null,!0):!1}function j(e){return n.screen!=="question"||n.currentWager!==null||![5,10,15].includes(e)?!1:(n.currentWager=e,!0)}function U(){return n.screen!=="question"||n.currentWager===null||n.showAnswer?!1:(n.showAnswer=!0,!0)}function H(){return n.screen!=="question"||n.currentWager===null||n.hasPassed?!1:(n.hasPassed=!0,n.answeringTeamId=T(n.choosingTeamId).id,!0)}function $(){if(n.screen!=="question"||n.currentWager===null)return!1;const e=n.answeringTeamId?l(n.answeringTeamId):l(n.choosingTeamId);e.score+=n.currentWager;const t=h();return t&&(t.used=!0),A()}function z(){if(n.screen!=="question"||n.currentWager===null||!n.hasPassed)return!1;const e=h();return e&&(e.used=!0),A()}function A(){return B(),n.choosingTeamId=T(n.choosingTeamId).id,W()?n.screen="end":n.screen="grid",!0}function D(e,t){if(n.gameStarted)return!1;const r=l(e);return r?(r.name=t,!0):!1}function F(e,t){if(n.gameStarted)return!1;const r=l(e);return r?(r.members.push(t),!0):!1}function G(e,t){if(n.gameStarted)return!1;const r=l(e);return!r||t<0||t>=r.members.length?!1:(r.members.splice(t,1),!0)}function R(e,t,r){if(n.gameStarted)return!1;const a=l(e);return!a||t<0||t>=a.members.length?!1:(a.members[t]=r,!0)}function _(){return n.editingScores?!1:(n.editingScores=!0,n.tempScores["team-a"]=n.teams[0].score,n.tempScores["team-b"]=n.teams[1].score,!0)}function K(){return n.editingScores?(n.editingScores=!1,!0):!1}function J(){return n.editingScores?(n.teams[0].score=n.tempScores["team-a"],n.teams[1].score=n.tempScores["team-b"],n.editingScores=!1,!0):!1}function X(e,t){if(!n.editingScores)return!1;const r=parseInt(t,10);return isNaN(r)?!1:(n.tempScores[e]=r,!0)}function Y(){const[e,t]=n.teams;return e.score>t.score?e:t.score>e.score?t:null}function c(e,t=document){return t.querySelector(e)}function s(e,t={},r=[]){const a=document.createElement(e);return Object.entries(t).forEach(([o,i])=>{o==="className"?a.className=i:o==="textContent"?a.textContent=i:o.startsWith("on")&&typeof i=="function"?a.addEventListener(o.substring(2).toLowerCase(),i):o==="disabled"?i&&(a.disabled=!0):a.setAttribute(o,i)}),r.forEach(o=>{typeof o=="string"?a.appendChild(document.createTextNode(o)):a.appendChild(o)}),a}function x(e){e.classList.remove("hidden")}function q(e){e.classList.add("hidden")}function Z(e,t,r){r?e.classList.add(t):e.classList.remove(t)}function m(e){for(;e.firstChild;)e.removeChild(e.firstChild)}const d={intro:null,setup:null,grid:null,question:null,end:null,error:null};function V(){d.intro=c("#intro-screen"),d.setup=c("#setup-screen"),d.grid=c("#grid-screen"),d.question=c("#question-screen"),d.end=c("#end-screen"),d.error=c("#error-screen")}function C(e){Object.values(d).forEach(r=>{r&&q(r)});const t=d[e];return t?(x(t),!0):!1}function b(){const e=c("#team-setup-container");m(e);const t=s("div",{className:"team-setup-grid"},[w(n.teams[0],0),w(n.teams[1],1)]);e.appendChild(t)}function w(e,t){return s("div",{className:"team-setup-panel"},[s("h3",{textContent:`Team ${t+1}`}),ee(e),te(e),ne(e)])}function ee(e){return s("input",{type:"text",className:"team-name-input",placeholder:"Enter team name...",value:e.name,onInput:t=>{D(e.id,t.target.value)}})}function te(e){const t=s("div",{className:"members-list"});return e.members.forEach((r,a)=>{const o=s("div",{className:"member-item"},[s("input",{type:"text",className:"member-input",placeholder:"Member name...",value:r,onInput:i=>{R(e.id,a,i.target.value)}}),s("button",{className:"remove-member-btn",textContent:"Remove",onClick:()=>{G(e.id,a),b()}})]);t.appendChild(o)}),t}function ne(e){return s("button",{className:"add-member-btn",textContent:"Add Member",onClick:()=>{F(e.id,""),b()}})}function f(e){m(e);const t=s("div",{className:"scoreboard"},[s("div",{className:"scoreboard-content"},[re(),se(),oe()])]);e.appendChild(t)}function re(){const e=I();return s("div",{className:"current-team-label",textContent:`Current Team: ${e.name}`})}function se(){return s("div",{className:"teams-container"},[v(n.teams[0]),v(n.teams[1])])}function v(e){const t=e.id===n.choosingTeamId,a=e.id===n.answeringTeamId?"team-score answering":t?"team-score choosing":"team-score",o=n.editingScores?ae(e):s("div",{className:"team-score-value",textContent:e.score.toString()});return s("div",{className:a},[s("div",{className:"team-name",textContent:e.name}),o,s("div",{className:"team-members",textContent:e.members.join(", ")})])}function ae(e){const t=s("input",{type:"number",className:"score-edit-input",value:n.tempScores[e.id].toString(),onInput:a=>{X(e.id,a.target.value)}}),r=s("div",{className:"score-edit-controls"},[s("button",{className:"save-scores-btn",textContent:"Save",onClick:()=>{J(),p()}}),s("button",{className:"cancel-scores-btn",textContent:"Cancel",onClick:()=>{K(),p()}})]);return s("div",{},[t,r])}function oe(){return n.editingScores?s("div"):s("button",{className:"edit-scores-btn",textContent:"Edit Scores",onClick:()=>{_(),p()}})}function p(){const e=c("#scoreboard-container"),t=c("#scoreboard-container-question");e&&f(e),t&&f(t)}function ie(){const e=c("#scoreboard-container");f(e);const t=c("#categories-container");m(t);const r=L(),a=s("div",{className:"categories-grid"});r.forEach(o=>{const i=ce(o);a.appendChild(i)}),t.appendChild(a)}function ce(e){const t=e.disabled?"category-tile disabled":"category-tile",r=s("div",{className:t},[s("div",{className:"category-name",textContent:e.name}),s("div",{className:"category-count",textContent:`${e.remainingCount} left`})]);return e.disabled||r.addEventListener("click",()=>{O(e.name)&&window.dispatchEvent(new CustomEvent("stateChanged"))}),r}function g(){const e=c("#scoreboard-container-question");f(e);const t=c("#question-container");m(t);const r=h();if(!r){t.appendChild(s("div",{textContent:"No question found"}));return}const a=s("div",{className:"question-content"},[s("div",{className:"question-category",textContent:n.currentCategory}),s("div",{className:"question-text",textContent:r.prompt}),ue(r),de(),le(),me()]);t.appendChild(a)}function ue(e){const t=s("div",{className:"question-answer",textContent:e.answer});return Z(t,"visible",n.showAnswer),t}function de(){if(!n.hasPassed)return s("div");const e=n.teams.find(t=>t.id===n.answeringTeamId);return s("div",{className:"pass-banner",textContent:`PASS TO ${e.name.toUpperCase()}`})}function le(){const e=s("div",{className:"wager-options"});return[5,10,15].forEach(t=>{const r=n.currentWager===t,a=n.currentWager!==null&&!r,i=s("button",{className:r?"wager-btn selected":"wager-btn",textContent:t.toString(),disabled:a,onClick:()=>{j(t)&&g()}});e.appendChild(i)}),s("div",{className:"wager-section"},[s("div",{className:"wager-title",textContent:"Select Wager:"}),e])}function me(){const e=s("div",{className:"question-controls"}),t=s("button",{className:"secondary-btn",textContent:"Show Answer",disabled:n.currentWager===null||n.showAnswer,onClick:()=>{U()&&g()}}),r=n.hasPassed?"End":"Pass",a=s("button",{className:"secondary-btn",textContent:r,disabled:n.currentWager===null,onClick:()=>{n.hasPassed?z()&&window.dispatchEvent(new CustomEvent("stateChanged")):H()&&g()}}),o=s("button",{className:"primary-btn",textContent:"Correct",disabled:n.currentWager===null,onClick:()=>{$()&&window.dispatchEvent(new CustomEvent("stateChanged"))}});return e.appendChild(t),e.appendChild(a),e.appendChild(o),e}function fe(){const e=c("#end-container");m(e);const t=Y(),r=s("div",{className:"end-content"},[ge(t),pe(),he()]);e.appendChild(r)}function ge(e){const t=e?`ðŸ† ${e.name} Wins!`:"It's a tie!";return s("div",{className:"winner-announcement",textContent:t})}function pe(){return s("div",{className:"final-scores"},[y(n.teams[0]),y(n.teams[1])])}function y(e){return s("div",{className:"final-team-score"},[s("div",{className:"final-team-name",textContent:e.name}),s("div",{className:"final-score-value",textContent:e.score.toString()})])}function he(){return s("div",{className:"team-members-final"},[S(n.teams[0]),S(n.teams[1])])}function S(e){const t=e.members.length>0?e.members.join(", "):"No members listed";return s("div",{className:"final-team-members"},[s("h3",{textContent:e.name}),s("div",{textContent:t})])}async function be(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(a)).map(u=>u.toString(16).padStart(2,"0")).join("")}async function N(e){if(!e||typeof e!="string")return!1;try{return await be(e.toLowerCase().trim())==="0182fc69169ad3febc5b995313df1c2e3b7ff44fd3e64ed811ceeec610cccd46"}catch(t){return console.error("Error validating access code:",t),!1}}function Ce(){return sessionStorage.getItem("quiz_authenticated")==="true"}function we(){sessionStorage.setItem("quiz_authenticated","true")}function ve(){sessionStorage.removeItem("quiz_authenticated")}class E{constructor(){this.init()}async init(){if(V(),this.setupEventListeners(),!await P()){this.showError();return}this.updateUI(),this.initializeAuth()}initializeAuth(){const t=c("#access-code-input"),r=c("#begin-setup-btn");n.screen==="intro"&&(ve(),t&&(t.value="",t.disabled=!1,t.placeholder="Enter access code"),r&&(r.disabled=!0,r.textContent="Enter Access Code"))}setupEventListeners(){const t=c("#access-code-input"),r=c("#access-code-error"),a=c("#begin-setup-btn");t==null||t.addEventListener("input",async i=>{const u=i.target.value;q(r),await N(u)?(we(),a.disabled=!1,a.textContent="Begin Setup"):(a.disabled=!0,a.textContent="Enter Access Code")}),t==null||t.addEventListener("keypress",async i=>{if(i.key==="Enter"){const u=i.target.value;!await N(u)&&u.length>0&&x(r)}}),a==null||a.addEventListener("click",()=>{Ce()&&(n.screen="setup",this.updateUI())});const o=c("#start-game-btn");o==null||o.addEventListener("click",()=>{M()?this.updateUI():alert("Please ensure both teams have names before starting the game.")}),window.addEventListener("stateChanged",()=>{this.updateUI()}),window.addEventListener("beforeunload",()=>{})}updateUI(){switch(C(n.screen),n.screen){case"intro":break;case"setup":b();break;case"grid":ie();break;case"question":g();break;case"end":fe();break;case"error":break;default:console.warn("Unknown screen:",n.screen)}}showError(){n.screen="error",C("error")}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{new E}):new E;
